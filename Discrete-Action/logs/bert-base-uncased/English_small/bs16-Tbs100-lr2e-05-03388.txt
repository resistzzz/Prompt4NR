| distributed init rank 0
Namespace(data_path='/home/nicole/Prompt4NR/DATA/English_small', cluster_data_avail='True', model_name='bert-base-uncased', prompt_type='original', max_topics=150, epochs=3, batch_size=16, test_batch_size=100, lr=2e-05, wd=0.001, max_his=50, max_tokens=500, num_negs=4, max_his_len=450, device='cuda', world_size=4, model_save=True, log=True, save_dir='./model_save/bert-base-uncased/English_small/2024-06-26-10-06-34', save_dir_bm='./temp/bert-base-uncased/English_small/2024-06-26', log_file='./logs/bert-base-uncased/English_small/bs16-Tbs100-lr2e-05-03388.txt', rank=0, gpu=0)
2) data_path known in process at rank 0 = /home/nicole/Prompt4NR/DATA/English_small
Vocabulary size of tokenizer after adding new tokens : 30523
num train: 136007	num val: 152836
User: [nsep] danish profile operated on last night out for four weeks [nsep] persons from the gang milieu beat brndby volunteers [nsep] several hundred danish football pitches are to be redone [nsep] danish hanne in shock cant prove that she knows danish [nsep] minister of defence the arctic is the first priority [nsep] the infection ravages the giro a huge shock [nsep] downfall for world champion [nsep] canada expels chinese diplomat accused of intimidation [nsep] responding to rumours absolutely impossible [nsep] desperate rescue attempt 19 out of 20 voted no [nsep] media commission will abolish 10th grade [nsep] hk withdraws support for lizette risgaard [nsep] fh chief executive suspended after revelations [nsep] nominated for a major award they violate peoples privacy [nsep] see jokkes appendix prince light [nsep] giant threatens immediate consequence [nsep] cheating for biltema editorinchief rages [nsep] victims of the trade boss her hand slaps me [nsep] streaming giant in massive purge deletes thousands of songs [nsep] they say we have too much sex [nsep] magnussen the hardest thing ive tried [nsep] joe biden surprises fewest in 30 years [nsep] ready for her 17th breast surgery [nsep] celebrities hung out in nude groups [nsep] crazy driving in a residential area children exposed to danger [nsep] after violent scenes minister will look at excluding away fans [nsep] normal picks up the ceo [nsep] new director in place [nsep] lizettes brutal past [nsep] wild wish saying no to zelenskyj [nsep] scandal huge danish ass [nsep] had orgasm during disney opera [nsep] here are the plans for epsteins horror island [nsep] georgia defies criticism and allows russian airline to land again [nsep] the metaverse flops badly loses billions [nsep] giga trade goes down the drain [nsep] danish corona expert dismissed after accusations of violations [nsep] agreement for 39 million dkk [nsep] ronaldo tops is the worlds bestpaid athlete [nsep] uncle reje exposed to serious threats and harassment dr police [nsep] big mystery about smashed millionaire car [nsep] golf stars are excluded from this years ryder cup [nsep] the moderates profile in accounting mess missing vouchers for dkk [nsep] hotel king buys villa for dkk 110 million [nsep] new job for fetterlein i havent managed a shit [nsep] danish mike in ukraine a hell of a lot [nsep] media moderates profile in speket moped purchase [nsep] star confronted with dating rumours [nsep] sren [SEP] News: Price rejects dismissal  Its just the way it is [SEP] Does the user click the news? [MASK]
User: [nsep] superstar wins in court [nsep] cnn receives criticism for trump interview a hit parade of [nsep] frederikke 20 years old and from nykbing f [nsep] total confusion lkke hits samsam back and forth [nsep] see the pictures helenes wild life in dubai [nsep] end after 32 years danish production company bankrupt [nsep] cleaning assistant drove 24000 km money please [nsep] the worlds dumbest drunk driver [nsep] woman accuses lizette risgaard far beyond my limits [nsep] man in van allegedly wanted to kill biden and take [nsep] tesla recalls over a million cars in china [nsep] american porn drama closing all access [nsep] police ask for help was it you [nsep] wild chaos everything is pretty much delayed [nsep] a year after the school shooting this is where the [nsep] eight people have been killed in new serbian mass shooting [nsep] madonna nudes up for auction for first time [nsep] brostrm why do men have nipples [nsep] former mayor is dead [nsep] announcing cancellation to danish festival must have surgery [nsep] energi requires government subsidies of dkk 315 billion [nsep] sweden protests over danish giant plan [nsep] lkkes headache keeps the door closed for terror twins [nsep] man stole wrong ambulance [nsep] i tested drugs for my pusher [nsep] mercedes dane on pole for formula 1 [nsep] crazy scottish beard law the complaints are pouring in [nsep] explains career stop i felt trapped [nsep] puts words to surprising tv comeback [nsep] kevin has been waiting for many years a natural [nsep] bad blood i dont care about him [nsep] disclosure received unemployment benefit by mistake [nsep] cash spree fingers crossed [nsep] zoo owner indicted tiger king in danish [nsep] casting doubts on naviair explanation are they lying [nsep] i thought no one would love me [nsep] danish star rejoices will be a mother again [nsep] star defrauded of avatar billions [nsep] after years of horror now he can rejoice [nsep] hopeless shitshow [nsep] badass bachelor girls drop it [nsep] trump sued now she strikes again [nsep] son of mafia boss shot dead during championship celebration [nsep] furious about demands the smart school doesnt go that [nsep] huge barter now they are the biggest [nsep] adidas puts remaining stock from the yeezy collection up for [nsep] brainwashed children this is where leftbehind syrian children can end [nsep] uncle reje exposed to serious threats and harassment dr police [nsep] police student started deadly fire [SEP] News: Arrest warrant for star Not paying child support [SEP] Does the user click the news? [MASK]
--------------------------------------------------------------------
start training:  2024-06-26 10:10:40.674240
Epoch:  0
lr: 2e-05
Train Loss: 0.2991
Train ACC: 0.9112	ACC-Positive: 0.0002	PositiveRatio: 0.0887	[1.25]
save file ./model_save/bert-base-uncased/English_small/2024-06-26-10-06-34/Epoch-0.pt
Validate: AUC: 0.5455	MRR: 0.3355	nDCG@5: 0.3699	nDCG@10: 0.4526	[Val-Time: 0.57]
Best Result: AUC: 0.5455 	MRR: 0.3355 	NDCG@5: 0.3699 	 NDCG@10: 0.4526
Best Epoch: AUC: 0 	MRR: 0 	NDCG@5: 0 	 NDCG@10: 0
--------------------------------------------------------------------
start training:  2024-06-26 11:59:55.240854
Epoch:  1
lr: 2e-05
Train Loss: 0.2905
Train ACC: 0.9113	ACC-Positive: 0.0000	PositiveRatio: 0.0887	[1.25]
save file ./model_save/bert-base-uncased/English_small/2024-06-26-10-06-34/Epoch-1.pt
Validate: AUC: 0.5514	MRR: 0.3381	nDCG@5: 0.3753	nDCG@10: 0.4552	[Val-Time: 0.56]
Best Result: AUC: 0.5514 	MRR: 0.3381 	NDCG@5: 0.3753 	 NDCG@10: 0.4552
Best Epoch: AUC: 1 	MRR: 1 	NDCG@5: 1 	 NDCG@10: 1
--------------------------------------------------------------------
start training:  2024-06-26 13:48:19.821869
Epoch:  2
lr: 2e-05
Train Loss: 0.2856
Train ACC: 0.9113	ACC-Positive: 0.0000	PositiveRatio: 0.0887	[1.25]
save file ./model_save/bert-base-uncased/English_small/2024-06-26-10-06-34/Epoch-2.pt
Validate: AUC: 0.5483	MRR: 0.3380	nDCG@5: 0.3754	nDCG@10: 0.4551	[Val-Time: 0.56]
Best Result: AUC: 0.5514 	MRR: 0.3381 	NDCG@5: 0.3754 	 NDCG@10: 0.4552
Best Epoch: AUC: 1 	MRR: 1 	NDCG@5: 2 	 NDCG@10: 1
Copy ./model_save/bert-base-uncased/English_small/2024-06-26-10-06-34/Epoch-1.pt >>> ./temp/bert-base-uncased/English_small/2024-06-26/BestModel.pt
